#!/usr/bin/env node

var sey = require('../src/main.js'),
    path = require('path'),
    commander = require('commander'),
    updateNotifier = require('update-notifier'),
    pkg = require('../package.json'),
    exitCode = 0;

updateNotifier({ pkg: pkg })
    .notify({ defer: false });

commander
    .version(pkg.version)
    .description(pkg.description)
    .usage('[options]')
    .option('-i, --init', 'initializes a sey file')
    .option('-f, --file <seyfile.js>', 'loads specified sey file');

commander.parse(process.argv);
commander.cli = true;

process.on('uncaughtException', function (err) {
    console.error(err.stack);
    exitCode = 1;
});

process.on('exit', function () {
    process.exit(exitCode);
});

var seyfile;

if (commander.file === undefined) {
    seyfile = path.join(process.cwd(), 'seyfile.js');
} else {
    if (!path.isAbsolute(commander.file)) {
        seyfile = path.join(process.cwd(), commander.file);
    } else {
        seyfile = commander.file;
    }
}

if (commander.init) {
    // copy __dirname + '/seyfile.sample.js' -> process.cwd() . '/seyfile.js'
} else {
    var result = require(seyfile);
}
